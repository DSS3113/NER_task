2022-11-13 18:24:01 - INFO: dict_items([('dataset', 'conll03'), ('save_path', './model_conll03.pt'), ('predict_path', './output_conll03.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 768), ('conv_hid_size', 96), ('bert_hid_size', 1024), ('biaffine_size', 768), ('ffnn_hid_size', 128), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 12), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 1.0), ('bert_name', 'bert-large-cased'), ('bert_learning_rate', 1e-05), ('warm_factor', 0.1), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/conll03.json'), ('device', 0)])
2022-11-13 18:24:01 - INFO: Loading Data
2022-11-13 18:24:04 - INFO: 
+---------+-----------+----------+
| conll03 | sentences | entities |
+---------+-----------+----------+
|  train  |   17291   |  29441   |
|   dev   |    3453   |   5648   |
|   test  |    3453   |   5648   |
+---------+-----------+----------+
2022-11-13 18:24:16 - INFO: Building Model
2022-11-13 18:24:20 - INFO: Epoch: 0
2022-11-13 19:56:42 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0682 | 0.5407 |   0.5786  | 0.6048 |
+---------+--------+--------+-----------+--------+
2022-11-13 19:59:25 - INFO: EVAL Label F1 [0.99960534 0.95266272 0.89994114 0.7340824  0.95826796 0.91704928]
2022-11-13 19:59:25 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9103 |   0.8949  | 0.9300 |
| Entity | 0.9028 |   0.8963  | 0.9093 |
+--------+--------+-----------+--------+
2022-11-13 20:02:05 - INFO: TEST Label F1 [0.99960534 0.95266272 0.89994114 0.7340824  0.95826796 0.91704928]
2022-11-13 20:02:05 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9103 |   0.8949  | 0.9300 |
| Entity | 0.9028 |   0.8963  | 0.9093 |
+--------+--------+-----------+--------+
2022-11-13 20:02:06 - INFO: Epoch: 1
2022-11-13 21:12:51 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0027 | 0.9390 |   0.9450  | 0.9334 |
+---------+--------+--------+-----------+--------+
2022-11-13 21:15:32 - INFO: EVAL Label F1 [0.99970009 0.96151545 0.90833085 0.81149264 0.97173035 0.93236715]
2022-11-13 21:15:32 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9309 |   0.9267  | 0.9353 |
| Entity | 0.9220 |   0.9224  | 0.9216 |
+--------+--------+-----------+--------+
2022-11-13 21:18:13 - INFO: TEST Label F1 [0.99970009 0.96151545 0.90833085 0.81149264 0.97173035 0.93236715]
2022-11-13 21:18:13 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9309 |   0.9267  | 0.9353 |
| Entity | 0.9220 |   0.9224  | 0.9216 |
+--------+--------+-----------+--------+
2022-11-13 21:18:13 - INFO: Epoch: 2
2022-11-13 22:30:15 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0017 | 0.9623 |   0.9646  | 0.9602 |
+---------+--------+--------+-----------+--------+
2022-11-13 22:32:57 - INFO: EVAL Label F1 [0.99967408 0.956111   0.89994079 0.80519481 0.96838811 0.93185894]
2022-11-13 22:32:57 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9269 |   0.9231  | 0.9311 |
| Entity | 0.9177 |   0.9180  | 0.9175 |
+--------+--------+-----------+--------+
2022-11-13 22:35:37 - INFO: TEST Label F1 [0.99967408 0.956111   0.89994079 0.80519481 0.96838811 0.93185894]
2022-11-13 22:35:37 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9269 |   0.9231  | 0.9311 |
| Entity | 0.9177 |   0.9180  | 0.9175 |
+--------+--------+-----------+--------+
2022-11-13 22:35:37 - INFO: Epoch: 3
2022-11-14 00:14:08 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0012 | 0.9720 |   0.9726  | 0.9714 |
+---------+--------+--------+-----------+--------+
2022-11-14 00:16:53 - INFO: EVAL Label F1 [0.99971912 0.96303696 0.91330166 0.83894059 0.96905283 0.93031566]
2022-11-14 00:16:53 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9357 |   0.9327  | 0.9389 |
| Entity | 0.9257 |   0.9252  | 0.9262 |
+--------+--------+-----------+--------+
2022-11-14 00:19:42 - INFO: TEST Label F1 [0.99971912 0.96303696 0.91330166 0.83894059 0.96905283 0.93031566]
2022-11-14 00:19:42 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9357 |   0.9327  | 0.9389 |
| Entity | 0.9257 |   0.9252  | 0.9262 |
+--------+--------+-----------+--------+
2022-11-14 00:19:43 - INFO: Epoch: 4
2022-11-14 02:07:40 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0009 | 0.9794 |   0.9795  | 0.9793 |
+---------+--------+--------+-----------+--------+
2022-11-14 02:10:29 - INFO: EVAL Label F1 [0.99968057 0.95484884 0.90081206 0.82548878 0.96888612 0.93365356]
2022-11-14 02:10:29 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9306 |   0.9238  | 0.9381 |
| Entity | 0.9212 |   0.9155  | 0.9269 |
+--------+--------+-----------+--------+
2022-11-14 02:13:18 - INFO: TEST Label F1 [0.99968057 0.95484884 0.90081206 0.82548878 0.96888612 0.93365356]
2022-11-14 02:13:18 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9306 |   0.9238  | 0.9381 |
| Entity | 0.9212 |   0.9155  | 0.9269 |
+--------+--------+-----------+--------+
2022-11-14 02:13:18 - INFO: Epoch: 5
2022-11-14 04:06:05 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0007 | 0.9847 |   0.9848  | 0.9845 |
+---------+--------+--------+-----------+--------+
2022-11-14 04:08:58 - INFO: EVAL Label F1 [0.99971772 0.96149266 0.91872792 0.83485594 0.97077114 0.93597836]
2022-11-14 04:08:58 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9369 |   0.9297  | 0.9445 |
| Entity | 0.9280 |   0.9237  | 0.9324 |
+--------+--------+-----------+--------+
2022-11-14 04:11:49 - INFO: TEST Label F1 [0.99971772 0.96149266 0.91872792 0.83485594 0.97077114 0.93597836]
2022-11-14 04:11:49 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9369 |   0.9297  | 0.9445 |
| Entity | 0.9280 |   0.9237  | 0.9324 |
+--------+--------+-----------+--------+
2022-11-14 04:11:50 - INFO: Epoch: 6
2022-11-14 05:46:42 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0005 | 0.9886 |   0.9884  | 0.9889 |
+---------+--------+--------+-----------+--------+
2022-11-14 05:49:48 - INFO: EVAL Label F1 [0.99970518 0.95987349 0.91768931 0.82442748 0.96898263 0.93337299]
2022-11-14 05:49:48 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9340 |   0.9250  | 0.9435 |
| Entity | 0.9255 |   0.9203  | 0.9308 |
+--------+--------+-----------+--------+
2022-11-14 05:52:41 - INFO: TEST Label F1 [0.99970518 0.95987349 0.91768931 0.82442748 0.96898263 0.93337299]
2022-11-14 05:52:41 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9340 |   0.9250  | 0.9435 |
| Entity | 0.9255 |   0.9203  | 0.9308 |
+--------+--------+-----------+--------+
2022-11-14 05:52:41 - INFO: Epoch: 7
2022-11-14 07:34:58 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0004 | 0.9918 |   0.9914  | 0.9922 |
+---------+--------+--------+-----------+--------+
2022-11-14 07:37:49 - INFO: EVAL Label F1 [0.99973073 0.9656     0.91829967 0.82519462 0.97026022 0.93440668]
2022-11-14 07:37:49 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9356 |   0.9321  | 0.9391 |
| Entity | 0.9265 |   0.9259  | 0.9271 |
+--------+--------+-----------+--------+
2022-11-14 07:40:36 - INFO: TEST Label F1 [0.99973073 0.9656     0.91829967 0.82519462 0.97026022 0.93440668]
2022-11-14 07:40:36 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9356 |   0.9321  | 0.9391 |
| Entity | 0.9265 |   0.9259  | 0.9271 |
+--------+--------+-----------+--------+
2022-11-14 07:40:36 - INFO: Epoch: 8
2022-11-14 09:14:15 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0002 | 0.9937 |   0.9933  | 0.9940 |
+---------+--------+--------+-----------+--------+
2022-11-14 09:17:29 - INFO: EVAL Label F1 [0.99971865 0.96104928 0.91651865 0.83321605 0.97057913 0.93596649]
2022-11-14 09:17:29 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9362 |   0.9288  | 0.9438 |
| Entity | 0.9272 |   0.9224  | 0.9320 |
+--------+--------+-----------+--------+
2022-11-14 09:20:19 - INFO: TEST Label F1 [0.99971865 0.96104928 0.91651865 0.83321605 0.97057913 0.93596649]
2022-11-14 09:20:19 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9362 |   0.9288  | 0.9438 |
| Entity | 0.9272 |   0.9224  | 0.9320 |
+--------+--------+-----------+--------+
2022-11-14 09:20:19 - INFO: Epoch: 9
2022-11-14 10:43:47 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0002 | 0.9947 |   0.9940  | 0.9954 |
+---------+--------+--------+-----------+--------+
2022-11-14 10:46:33 - INFO: EVAL Label F1 [0.99972423 0.96411483 0.9197861  0.82642305 0.97123415 0.93821236]
2022-11-14 10:46:33 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9366 |   0.9302  | 0.9432 |
| Entity | 0.9283 |   0.9243  | 0.9324 |
+--------+--------+-----------+--------+
2022-11-14 10:49:18 - INFO: TEST Label F1 [0.99972423 0.96411483 0.9197861  0.82642305 0.97123415 0.93821236]
2022-11-14 10:49:18 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9366 |   0.9302  | 0.9432 |
| Entity | 0.9283 |   0.9243  | 0.9324 |
+--------+--------+-----------+--------+
2022-11-14 10:49:19 - INFO: Best DEV F1: 0.9283
2022-11-14 10:49:19 - INFO: Best TEST F1: 0.9283
2022-11-14 10:52:04 - INFO: TEST Label F1 [0.99972423 0.96411483 0.9197861  0.82642305 0.97123415 0.93821236]
2022-11-14 10:52:04 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.9366 |   0.9302  | 0.9432 |
|   Entity   | 0.9283 |   0.9243  | 0.9324 |
+------------+--------+-----------+--------+
